#!/usr/bin/env python

"""hcarch: archives recent hipchat room histories

Queries all rooms, and then queries the recent history for each of them.

TODO: rename this script?
"""

__author__      = "Joel Dubowy"
__copyright__   = "Copyright (c) 2015 AirFire, PNW, USFS"

from pyairfire import scripting
from pyairfire.hipchat.archive import HipChatArchiver

REQUIRED_ARGS = [
    {
        'short': '-n',
        'long': '--num-days'
        'dest': 'num_days',
        'help': 'number of days in the past (from now)',
        'action': 'store'
    },
    {
        'short': '-a',
        'long': '--auth-token',
        'dest': 'auth_token',
        'help': 'API Auth token',
        'action': store
    }
]

OPTIONAL_ARGS = [
    {
        'short': '-d',
        'long': '--dest-dir'
        'dest': 'dest_dir',
        'help': 'directory to store archive',
        'action': 'store'
    },
    {
        'short': '-e',
        'long': '--email-recipients'
        'dest': 'email_recipients',
        'help': 'email address to recieve archive',
        'action': 'store'
    }

]

if __name__ == "__main__":
    parser, args = scripting.args.parse_args(REQUIRED_ARGS, [])

    archiver = HipChatArchiver(args.auth_token, args.num_days,
        dest_dir=args.dest_dir, email_recipients=args.email_recipients)
    arciver.archive()

